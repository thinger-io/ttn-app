<div class="bg-light lter b-b wrapper-md">
    <div>
        <h1 class="m-n font-thin h3 text-black">The Things Network</h1>
    </div>
</div>
<div class="panel panel-default">
    <div class="panel-heading font-bold">
        <i class="fa fa-cog m-r-xs"></i> Settings
    </div>
    <div class="panel-body">
        <form id="form-save-callback" class="form-validation" ng-submit="save()">
            <uib-tabset class="tab-container m-b-none" ng-disabled="save_state==1">
                <uib-tab heading="Uplink Processing">
                    <div class="form-group">
                        <label><i class="fa fa-magic m-r-xs text-muted"></i>Auto provision resources <i class="fa fa-info-circle text-muted" uib-popover="Automatically create devices and buckets to store incoming data" popover-trigger="'mouseenter'"></i></label>
                        <div class="m-t-xs">
                            <label class="i-switch bg-success">
                                <input type="checkbox" ng-model="settings.value.auto_provision_resources">
                                <i></i>
                            </label>
                        </div>
                    </div>
                    <div ng-if="settings.value.auto_provision_resources">
                        <div class="form-group">
                            <label><i class="fa fa-clock m-r-xs text-muted"></i>Device Connection Timeout <i class="fa fa-info-circle text-muted" uib-popover="Number of minutes without an uplink call to consider the device as disconnected" popover-trigger="'mouseenter'"></i></label>
                            <input type="number" placeholder="10" class="form-control" ng-model="settings.value.device_connection_timeout"/>
                        </div>
                        <div class="form-group">
                            <label><i class="fa fa-rocket m-r-xs  text-muted"></i>Device Identifier Prefix <i class="fa fa-info-circle text-muted" uib-popover="Specify a prefix (if required), to be set when creating the new device identifier." popover-trigger="'mouseenter'"></i></label>
                            <input type="text" placeholder="ttn_" class="form-control" ng-model="settings.value.device_id_prefix"/>
                        </div>
                        <div class="form-group">
                            <label><i class="fa fa-database m-r-xs text-muted"></i>Bucket Identifier Prefix <i class="fa fa-info-circle text-muted" uib-popover="Specify a prefix (if required), to be set when creating the new bucket identifier." popover-trigger="'mouseenter'"></i></label>
                            <input type="text" placeholder="ttn_" class="form-control" ng-model="settings.value.bucket_id_prefix"/>
                        </div>
                    </div>
                </uib-tab>
                <uib-tab heading="Device Properties">
                    <div class="form-group">
                        <label><i class="fa fa-map-marked m-r-xs text-muted"></i>Update device location <i class="fa fa-info-circle text-muted" uib-popover="Set location property based on the gateway location" popover-trigger="'mouseenter'"></i></label>
                        <div class="m-t-xs">
                            <label class="i-switch bg-success">
                                <input type="checkbox" ng-model="settings.value.update_device_location">
                                <i></i>
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label><i class="fa fa-microchip m-r-xs text-muted"></i>Save hardware serial <i class="fa fa-info-circle text-muted" uib-popover="Set hardware serial property" popover-trigger="'mouseenter'"></i></label>
                        <div class="m-t-xs">
                            <label class="i-switch bg-success">
                                <input type="checkbox" ng-model="settings.value.save_hardware_serial">
                                <i></i>
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label><i class="fa fa-download m-r-xs text-muted"></i>Save downlink URL <i class="fa fa-info-circle text-muted" uib-popover="Set downlink URL property" popover-trigger="'mouseenter'"></i></label>
                        <div class="m-t-xs">
                            <label class="i-switch bg-success">
                                <input type="checkbox" ng-model="settings.value.save_downlink_url">
                                <i></i>
                            </label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label><i class="fa fa-list-ul m-r-xs text-muted"></i> Save metadata <i class="fa fa-info-circle text-muted" uib-popover="Set metadata property" popover-trigger="'mouseenter'"></i></label>
                        <div class="m-t-xs">
                            <label class="i-switch bg-success">
                                <input type="checkbox" ng-model="settings.value.save_metadata">
                                <i></i>
                            </label>
                        </div>
                    </div>
                </uib-tab>
                <uib-tab heading="TTN Integration">
                    <div class="font-bold m-b-xs"><i class="fa fa-link"></i> Method</div>
                    <pre class="bg-black text-white">POST</pre>
                    <div class="font-bold m-b-xs"><i class="fa fa-link"></i> URL</div>
                    <pre class="bg-black text-white">{{plugin.taskUrl}}/uplink</pre>
                    <div class="font-bold m-b-xs"><i class="fa fa-lock"></i> Authorization Header</div>
                    <pre class="bg-black text-white">Bearer {{ttn_plugin_callback}} </pre>
                </uib-tab>
            </uib-tabset>
        </form>
        <pre class="alert alert-danger m-t m-b-none" ng-show="save_state==3"><strong><i class="fas fa-thumbs-down"></i> Ooops!</strong> Cannot process your request. Error {{error_code}} ({{error_message}})</pre>
    </div>
    <footer class="panel-footer text-left bg-light lter">
        <button class="btn btn-success btn-addon" type="submit" form="form-save-callback" ng-disabled="fetch_error || save_state==1"><i><span ng-class="{'fa fa-check': save_state!=1, 'fa fa-spinner fa-pulse' : save_state==1}"></span></i>Save</button>
    </footer>
</div>